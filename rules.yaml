---
- name: iam_key_max_age_days
  threshold: 30
  purpose: If you do have an access key for your AWS account, delete it. If you must keep it, rotate (change) the access key regularly
  control: Periodically check for key age and make stale keys inactive while removing unused keys or rotating them where they are still used
- name: password_policy_on
  purpose: Configure a Strong Password Policy for Your Users. If you allow users to change their own passwords, require that they create strong passwords and that they rotate their passwords periodically
  control: Apply the Password Policy for your IAM Users and allow users to change their own password
  settings:
    AllowUsersToChangePassword: true
    ExpirePasswords: true
# CIS 1.11  Ensure IAM password policy expires passwords within 90 days or less
    MaxPasswordAge: 90
# CIS 1.9 Ensure IAM password policy requires minimum length of 14 or greater
    MinimumPasswordLength: 14
# CIS 1.10  Ensure IAM password policy prevents password reuse
    PasswordReusePrevention: 10
# CIS 1.6 Ensure IAM password policy require at least one lowercase letter
    RequireLowercaseCharacters: true
# CIS 1.8 Ensure IAM password policy require at least one number
    RequireNumbers: true
# CIS 1.7 Ensure IAM password policy require at least one symbol
    RequireSymbols: true
# CIS 1.5 Ensure IAM password policy requires at least one uppercase letter
    RequireUppercaseCharacters: true
- name: config_recording
  purpose: Determine whether there is at least one Config recorder recording
  control: tba
  regions:
    - ap-southeast-2
- name: cloudtrail_log_delivery
  purpose: Determine whether any of the trails are delivering logs to CloudWatch Logs
  control: tba
  regions:
    - ap-southeast-2
# CIS 1.13	Ensure MFA is enabled for the "root" account
- name: root_account_mfa_enabled
  purpose: Determine whether the root account has MFA enabled
# CIS 1.14	Ensure hardware MFA is enabled for the "root" account
  hardwareMFA: true
  control: tba
# CIS 1.12	Ensure no root account access key exists
- name: root_account_active_access_keys
  purpose: Determine whether the root account has active access keys
  control: tba
# CIS 4.3	Ensure VPC flow logging is enabled in all VPCs
- name: enabled_vpc_flow_logs
  purpose: Determine whether the root account has active access keys
  control: tba
  regions:
    - ap-southeast-2




- name: cis_avoid_the_use_of_the_root_account
  version: 1.2.0
  recommendation: 1.1
  level: 1
  scored: True
  purpose: The "root" account is the most privileged AWS account. Minimizing the use of this account and adopting the principle of least privilege for access management will reduce the risk of accidental changes and unintended disclosure of highly privileged credentials
  control: Ensure that all users with administrative account access use a dedicated or secondary account for elevated activities. This account should only be used for administrative activities and not internet browsing, email, or similar activities
  settings:
    password_used: 90
    access_key_used: 0
    certificate_rotated: 30

- name: ensure_mfa_is_enabled_for_all_iam_users_that_have_a_console_password
  version: 1.2.0
  recommendation: 1.2
  level: 1
  scored: True
  purpose: Enabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that emits a time-sensitive key and have knowledge of a credential
  control: Use multi-factor authentication and encrypted channels for all administrative account access

- name: ensure_credentials_unused_for_90_days_or_greater_are_disabled
  version: 1.2.0
  recommendation: 1.3
  level: 1
  scored: True
  purpose: Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used
  control: Automatically disable dormant accounts after a 90 day period of inactivity
